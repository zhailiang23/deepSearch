---
name: 统计计算服务开发
status: open
created: 2025-09-28T07:38:06Z
updated: 2025-09-28T07:50:47Z
github: https://github.com/zhailiang23/deepSearch/issues/109
depends_on: []
parallel: true
conflicts_with: []
---


# Task: 统计计算服务开发

## Description
开发MismatchAnalysisService服务，实现搜索关键词不匹配度的核心计算逻辑。采用分层权重算法，对无结果和少结果的搜索进行不同权重的统计，结合中文分词服务进行关键词标准化处理，支持灵活的时间范围查询。

## Acceptance Criteria
- [ ] 创建MismatchAnalysisService服务类，实现不匹配度计算的核心业务逻辑
- [ ] 实现分层权重不匹配度算法：无结果权重1.0，少结果(1-5个)权重0.6
- [ ] 集成现有ChineseSegmentationService，实现关键词标准化和同义词合并
- [ ] 实现时间范围查询逻辑，支持按日、周、月进行统计
- [ ] 提供批量计算接口，支持大量搜索日志的高效处理
- [ ] 实现缓存机制，避免重复计算相同时间段的统计结果

## Technical Details
- 服务类位置：backend/src/main/java/com/ynet/mgmt/service/MismatchAnalysisService.java
- 权重算法实现：
  - 无结果搜索(result_count = 0)：权重 = 1.0
  - 少结果搜索(result_count 1-5)：权重 = 0.6
  - 正常结果搜索(result_count > 5)：权重 = 0
- 集成服务：ChineseSegmentationService（关键词分词和标准化）
- 缓存策略：Spring Cache注解，缓存时间段统计结果
- 查询优化：利用任务001创建的复合索引进行高效查询
- 时间范围支持：TODAY, LAST_7_DAYS, LAST_30_DAYS, CUSTOM_RANGE

## Dependencies
- [ ] 任务001：数据库索引创建完成
- [ ] ChineseSegmentationService服务可用
- [ ] Spring Cache配置正确

## Effort Estimate
- Size: M
- Hours: 16-24小时
- Parallel: false

## Definition of Done
- [ ] MismatchAnalysisService服务实现完成
- [ ] 分层权重算法测试通过，计算结果准确
- [ ] 与ChineseSegmentationService集成测试通过
- [ ] 时间范围查询功能测试通过
- [ ] 单元测试覆盖率达到90%以上
- [ ] 性能测试：支持万级搜索日志的秒级计算
- [ ] 代码审查完成
- [ ] 服务接口文档编写完成
