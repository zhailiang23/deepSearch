---
name: statistics-mismatch-keyword
status: backlog
created: 2025-09-28T07:23:53Z
progress: 0%
prd: .claude/prds/statistics-mismatch-keyword.md
github: [Will be updated when synced to GitHub]
---

# Epic: statistics-mismatch-keyword

## Overview

实现银行搜索系统中的关键词不匹配度分析功能，通过集成中文分词技术和分层权重算法，实时计算并展示Top10高不匹配度关键词排行榜。系统采用Spring Boot后端处理复杂的统计计算逻辑，Vue.js前端提供直观的数据展示界面，支持多时间维度分析和阈值配置。

## Architecture Decisions

### 核心技术选型
- **分词引擎**: 选择jieba-java作为中文分词库，性能稳定且支持自定义词典
- **计算策略**: 实时计算架构，避免预计算数据一致性问题，通过数据库优化保证性能
- **缓存设计**: 使用Redis进行短期结果缓存，平衡实时性和性能要求
- **数据库优化**: 在searchLog表创建复合索引，支持高效的时间范围和关键词查询

### 设计模式
- **服务层模式**: 分离分词服务、统计计算服务和排行榜生成服务
- **策略模式**: 不匹配度计算算法可配置，支持未来算法优化
- **观察者模式**: 配置变更时通知相关计算组件更新参数

## Technical Approach

### Frontend Components
- **时间选择器组件**: 支持7天/30天/90天三个预设选项
- **排行榜表格组件**: 展示关键词统计数据，支持排序和筛选
- **加载状态组件**: 实时计算期间的友好提示界面
- **配置管理组件**: 管理员调整少结果阈值的界面

### Backend Services
- **分词处理服务** (`KeywordSegmentationService`):
  - 集成jieba-java分词库
  - 实现停用词过滤和词长验证
  - 支持银行业务专用词典加载

- **统计计算服务** (`MismatchAnalysisService`):
  - 实现分层权重不匹配度算法
  - 支持可配置的少结果阈值
  - 优化的SQL查询逻辑

- **排行榜服务** (`RankingService`):
  - Top10关键词筛选和排序
  - 结果格式化和数据封装

- **配置管理服务** (`ConfigurationService`):
  - 阈值参数的动态配置
  - 配置变更的实时生效

### Infrastructure
- **数据库索引**: 在searchLog表的(timestamp, keyword, result_count)字段创建复合索引
- **缓存层**: Redis存储分词结果和计算结果的短期缓存
- **监控**: 集成现有监控系统，追踪计算性能和响应时间
- **安全**: 复用现有认证授权机制，确保数据访问安全

## Implementation Strategy

### 开发阶段
1. **Phase 1 - 基础设施** (Week 1):
   - 集成jieba-java分词库
   - 创建数据库索引和查询优化
   - 建立基础的服务架构

2. **Phase 2 - 核心算法** (Week 2):
   - 实现分层权重不匹配度计算
   - 开发统计查询和排行榜生成逻辑
   - 添加配置管理功能

3. **Phase 3 - 前端界面** (Week 3):
   - 创建排行榜展示组件
   - 实现时间范围选择和实时查询
   - 添加加载状态和错误处理

4. **Phase 4 - 优化与测试** (Week 4):
   - 性能优化和缓存策略实施
   - 全面测试和bug修复
   - 部署和上线准备

### 风险缓解
- **性能风险**: 通过数据库索引优化和缓存策略降低查询延迟
- **分词准确性**: 配置银行业务专用词典，提升分词质量
- **数据一致性**: 使用事务确保统计计算的准确性
- **并发处理**: 限制并发用户数，避免系统过载

### 测试策略
- **单元测试**: 重点测试分词逻辑和不匹配度计算算法
- **集成测试**: 验证前后端数据交互和API接口
- **性能测试**: 模拟大数据量场景，验证5秒响应时间要求
- **用户验收测试**: 与数据分析师和产品经理验证功能完整性

## Task Breakdown Preview

基于需求分析，将创建以下高级任务类别：

- [ ] **数据库优化**: 创建索引、查询优化、确保searchLog表支持结果数量字段
- [ ] **分词服务集成**: 集成jieba-java、配置停用词典、实现分词处理接口
- [ ] **统计计算引擎**: 实现分层权重算法、时间范围查询、Top10排行榜生成
- [ ] **配置管理系统**: 少结果阈值配置、动态参数更新、配置持久化
- [ ] **前端排行榜界面**: 数据表格展示、时间选择器、实时查询交互
- [ ] **缓存优化方案**: Redis缓存集成、缓存策略实施、性能监控
- [ ] **API接口开发**: RESTful接口设计、数据格式定义、错误处理
- [ ] **测试与部署**: 单元测试、集成测试、性能测试、生产部署

## Dependencies

### 外部服务依赖
- **searchLog数据表**: 必须包含关键词、时间戳、搜索结果状态、结果数量字段
- **jieba-java分词库**: Maven依赖，版本1.0.2或更高
- **PostgreSQL数据库**: 支持复杂查询和索引优化的稳定版本
- **Redis缓存**: 用于短期数据缓存的Redis实例

### 内部团队依赖
- **数据团队**: 确认searchLog表结构，提供数据质量保证
- **DBA团队**: 协助数据库查询优化和索引设计
- **运维团队**: 提供Redis缓存服务和性能监控支持
- **安全团队**: 审核数据访问权限和用户认证流程

### 前置工作
- searchLog表必须记录搜索结果数量字段
- 确认现有用户权限系统的集成方案
- Redis缓存服务的可用性确认

## Success Criteria (Technical)

### 性能基准
- **响应时间**: 实时计算在5秒内完成率 ≥ 95%
- **并发处理**: 支持5个用户同时查询无性能劣化
- **分词速度**: 处理速度 ≥ 1000词/秒
- **数据处理能力**: 单次处理10万条搜索记录

### 质量门禁
- **代码覆盖率**: 核心业务逻辑测试覆盖率 ≥ 90%
- **分词准确率**: 中文分词结果准确性 ≥ 95%
- **计算准确性**: 统计结果与手工验证一致性 ≥ 99%
- **系统稳定性**: 连续运行24小时无故障

### 验收标准
- 用户可选择3个时间范围进行分析
- 排行榜准确显示Top10关键词及详细统计
- 支持少结果阈值的动态配置
- 计算结果实时更新，支持页面刷新重新计算

## Estimated Effort

### 总体时间估算
- **开发周期**: 4周 (160工时)
- **测试周期**: 1周 (40工时)
- **部署上线**: 3天 (24工时)
- **总计**: 224工时

### 资源需求
- **后端开发**: 2名开发人员 × 3周
- **前端开发**: 1名开发人员 × 2周
- **测试工程师**: 1名 × 1周
- **DBA支持**: 0.5名 × 2周

### 关键路径项目
1. **数据库索引创建**: 必须在开发开始前完成
2. **分词库集成**: 影响后续所有计算逻辑开发
3. **统计算法实现**: 核心功能，影响前端界面开发
4. **性能优化**: 决定系统是否满足5秒响应要求

### 风险缓冲
- 预留20%时间用于性能优化和bug修复
- 分词准确性调优可能需要额外1-2天
- 大数据量测试和优化预留3天缓冲时间