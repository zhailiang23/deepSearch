---
name: API接口开发
status: open
created: 2025-09-28T07:38:06Z
updated: 2025-09-28T07:50:47Z
github: https://github.com/zhailiang23/deepSearch/issues/107
depends_on: []
parallel: true
conflicts_with: []
---

name: API接口开发
status: pending
created: 2025-09-28T07:38:06Z
updated: 2025-09-28T07:38:06Z
github:
depends_on: ["003"]
parallel: []
conflicts_with: []
---

## Description

为关键词不匹配度排行榜功能设计和实现RESTful API接口，提供完整的数据查询和响应能力。

## Acceptance Criteria

- [ ] 设计RESTful API端点结构
- [ ] 实现关键词不匹配度排行榜查询接口
- [ ] 支持时间范围参数（7天/30天/90天）
- [ ] 定义统一的数据格式和响应结构
- [ ] 实现完整的错误处理和异常响应
- [ ] 提供API文档和使用示例
- [ ] 通过单元测试和集成测试验证

## Technical Details

### API端点设计
```
GET /api/statistics/mismatch-keywords/ranking
参数：
- timeRange: enum(7d, 30d, 90d) - 查询时间范围
- page: int - 分页页码（可选，默认1）
- size: int - 每页大小（可选，默认20）
```

### 响应数据结构
```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "ranking": [
      {
        "keyword": "搜索关键词",
        "mismatchRate": 0.75,
        "searchCount": 1250,
        "mismatchCount": 938,
        "rank": 1
      }
    ],
    "timeRange": "7d",
    "totalCount": 100,
    "page": 1,
    "size": 20,
    "hasNext": true
  }
}
```

### 错误处理
- 参数验证错误：400 Bad Request
- 数据查询异常：500 Internal Server Error
- 无数据情况：200 OK with empty array

### 实现要点
1. 控制器层（Controller）
   - 参数验证和类型转换
   - 调用服务层获取数据
   - 统一响应格式封装

2. 数据传输对象（DTO）
   - RankingQueryRequest - 查询请求参数
   - RankingQueryResponse - 查询响应数据
   - MismatchKeywordRankingDTO - 排行榜条目

3. 参数验证
   - 时间范围枚举验证
   - 分页参数合法性检查
   - 请求频率限制

## Dependencies

- 任务003：排行榜服务（HotWordRankingService）
- Spring Boot Web框架
- Bean Validation注解
- Jackson JSON序列化

## Effort Estimate

**1-2天**

- API设计和端点定义：0.5天
- 控制器和DTO实现：0.5天
- 错误处理和响应封装：0.5天
- 单元测试和集成测试：0.5天

## Definition of Done

- [ ] API端点正确响应查询请求
- [ ] 支持所有时间范围参数
- [ ] 返回数据格式符合设计规范
- [ ] 错误处理覆盖所有异常情况
- [ ] 单元测试覆盖率达到90%以上
- [ ] 集成测试验证完整流程
- [ ] API文档更新完整
- [ ] 代码审查通过并合并到主分支
