---
name: 实现后端 Mapping API 端点
status: open
created: 2025-09-26T04:12:20Z
updated: 2025-09-26T04:21:27Z
github: https://github.com/zhailiang23/deepSearch/issues/62
depends_on: []
parallel: true
conflicts_with: []
---

# Task: 实现后端 Mapping API 端点

## Description

在后端实现两个新的 REST API 端点，用于获取和更新 Elasticsearch 索引的 mapping 配置。扩展现有的 SearchSpaceController，添加 mapping 相关的控制器方法。

## Acceptance Criteria

- [ ] 新增 GET `/api/search-spaces/{id}/mapping` 端点
- [ ] 新增 PUT `/api/search-spaces/{id}/mapping` 端点
- [ ] 实现完整的请求参数验证
- [ ] 添加适当的响应状态码和错误处理
- [ ] 支持 JSON 格式的请求和响应
- [ ] 遵循现有 API 设计规范
- [ ] 添加 API 文档注释

## Technical Details

**文件位置：** `backend/src/main/java/com/ynet/mgmt/controller/SearchSpaceController.java`

**API 端点设计：**

1. **获取 Mapping API：**
```java
@GetMapping("/{id}/mapping")
public ResponseEntity<String> getIndexMapping(@PathVariable Long id) {
    // 实现逻辑
}
```

2. **更新 Mapping API：**
```java
@PutMapping("/{id}/mapping")
public ResponseEntity<Void> updateIndexMapping(
    @PathVariable Long id,
    @RequestBody String mappingJson
) {
    // 实现逻辑
}
```

**响应格式：**
- GET 请求：返回 JSON 字符串格式的 mapping 配置
- PUT 请求：成功返回 204 No Content，失败返回相应错误信息

**错误处理：**
- 404: 搜索空间不存在
- 400: JSON 格式错误
- 500: Elasticsearch 连接错误
- 403: 权限不足（如需要）

## Dependencies

- [ ] 现有 SearchSpaceController 正常工作
- [ ] SearchSpaceService 具备基础功能
- [ ] Elasticsearch 客户端配置可用

## Effort Estimate

- Size: M
- Hours: 6-8 小时
- Parallel: true（可与前端任务并行）

## Definition of Done

- [ ] GET mapping 端点实现并测试通过
- [ ] PUT mapping 端点实现并测试通过
- [ ] 请求参数验证正确
- [ ] 错误处理机制完善
- [ ] API 文档注释完整
- [ ] 单元测试覆盖所有端点
- [ ] 集成测试验证 API 功能
- [ ] Postman/API 测试工具验证通过
- [ ] 符合项目 RESTful API 规范
