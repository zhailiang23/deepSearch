---
id: basic-mgmt-system-001
title: 项目初始化：搭建Spring Boot项目，集成Spring Data JPA和PostgreSQL
epic: basic-mgmt-system
status: not_started
priority: high
effort: 2
created: 2025-09-21T08:08:39Z
depends_on: []
blocks: [basic-mgmt-system-002, basic-mgmt-system-008]
parallel: false
tags: [backend, spring-boot, jpa, postgresql, setup]
assignee: ""
---

# 项目初始化：搭建Spring Boot项目，集成Spring Data JPA和PostgreSQL

## 描述

搭建基础管理系统的Spring Boot后端项目，配置Spring Data JPA和PostgreSQL数据库连接，建立项目基础架构。这是整个项目的技术基础，为后续的实体设计和API开发奠定框架。

## 验收标准

### 功能要求
- [ ] Spring Boot 3.2+ 项目结构完整且可启动
- [ ] Spring Data JPA 集成配置正确
- [ ] PostgreSQL 数据库连接配置完成
- [ ] 基础配置文件设置正确（application.yml）
- [ ] 项目目录结构符合Maven标准
- [ ] 基础的健康检查端点可用

### 技术要求
- [ ] 使用Java 17+
- [ ] Maven构建配置正确
- [ ] 包含必要的starter依赖
- [ ] 数据库连接池配置（HikariCP）
- [ ] JPA审计功能启用
- [ ] 基础异常处理配置

### 质量要求
- [ ] 项目可以正常启动无错误
- [ ] 数据库连接测试通过
- [ ] 基础的application.yml配置合理
- [ ] Maven依赖版本管理正确

## 技术实施

### 1. 项目结构设计

```
backend/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/ynet/mgmt/
│   │   │       ├── MgmtApplication.java          # 主启动类
│   │   │       ├── config/                      # 配置类
│   │   │       │   ├── DatabaseConfig.java
│   │   │       │   └── JpaConfig.java
│   │   │       ├── entity/                      # JPA实体
│   │   │       ├── repository/                  # JPA Repository
│   │   │       ├── service/                     # 业务逻辑层
│   │   │       └── controller/                  # REST控制器
│   │   └── resources/
│   │       ├── application.yml                  # 主配置文件
│   │       ├── application-dev.yml              # 开发环境配置
│   │       └── application-prod.yml             # 生产环境配置
│   └── test/
│       └── java/
│           └── com/ynet/mgmt/
│               └── MgmtApplicationTests.java
├── pom.xml                                     # Maven配置
└── README.md
```

### 2. 核心依赖配置

#### pom.xml 关键依赖
```xml
<properties>
    <java.version>17</java.version>
    <spring.boot.version>3.2.1</spring.boot.version>
</properties>

<dependencies>
    <!-- Spring Boot Starters -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-actuator</artifactId>
    </dependency>

    <!-- Database -->
    <dependency>
        <groupId>org.postgresql</groupId>
        <artifactId>postgresql</artifactId>
        <scope>runtime</scope>
    </dependency>

    <!-- Testing -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
        <scope>test</scope>
    </dependency>
</dependencies>
```

### 3. 数据库配置

#### application.yml
```yaml
spring:
  application:
    name: basic-mgmt-system

  datasource:
    url: jdbc:postgresql://localhost:5432/mgmt_db
    username: ${DB_USERNAME:admin}
    password: ${DB_PASSWORD:password}
    driver-class-name: org.postgresql.Driver

    # HikariCP 连接池配置
    hikari:
      pool-name: HikariCP
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 20000
      idle-timeout: 300000
      max-lifetime: 1200000

  jpa:
    hibernate:
      ddl-auto: create-drop  # 开发阶段使用，生产环境改为validate
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        use_sql_comments: true
    open-in-view: false

  # 开启JPA审计
  data:
    jpa:
      repositories:
        bootstrap-mode: deferred

# Actuator健康检查
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when_authorized

# 日志配置
logging:
  level:
    com.example.mgmt: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
```

### 4. JPA配置类

#### JpaConfig.java
```java
@Configuration
@EnableJpaRepositories(basePackages = "com.example.mgmt.repository")
@EnableJpaAuditing
public class JpaConfig {

    @Bean
    public AuditorAware<String> auditorProvider() {
        return () -> Optional.of("system"); // 后续与认证系统集成
    }
}
```

### 5. 基础实体类（为JPA做准备）

#### BaseEntity.java
```java
@MappedSuperclass
@EntityListeners(AuditingEntityListener.class)
public abstract class BaseEntity {

    @CreatedDate
    @Column(name = "created_at", nullable = false, updatable = false)
    private LocalDateTime createdAt;

    @LastModifiedDate
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @CreatedBy
    @Column(name = "created_by", length = 50)
    private String createdBy;

    @LastModifiedBy
    @Column(name = "updated_by", length = 50)
    private String updatedBy;

    // getters and setters
}
```

## 实施步骤

### 阶段1：项目结构创建（0.5天）
1. 使用Spring Initializr创建项目骨架
2. 配置Maven pom.xml文件
3. 创建标准的包结构
4. 设置基础的应用程序入口点

### 阶段2：数据库集成（0.5天）
1. 配置PostgreSQL依赖和连接参数
2. 设置HikariCP连接池
3. 配置JPA和Hibernate属性
4. 创建数据库配置类

### 阶段3：基础配置（0.5天）
1. 设置多环境配置文件
2. 配置JPA审计功能
3. 添加Actuator健康检查
4. 设置日志配置

### 阶段4：测试验证（0.5天）
1. 编写基础的集成测试
2. 验证数据库连接
3. 测试应用启动
4. 验证健康检查端点

## 风险和注意事项

### 技术风险
- **数据库连接问题**：确保PostgreSQL实例正确配置和运行
- **依赖版本冲突**：仔细管理Spring Boot和依赖库版本
- **JPA配置错误**：注意Hibernate方言和DDL策略设置

### 缓解措施
- 使用Docker Compose提供一致的开发数据库环境
- 采用Spring Boot BOM管理依赖版本
- 配置详细的错误日志便于问题诊断
- 提供完整的README文档说明本地开发环境设置

## 依赖关系

### 前置条件
- Java 17+ 开发环境
- Maven 3.8+ 构建工具
- PostgreSQL 15+ 数据库实例
- IDE开发环境（推荐IntelliJ IDEA）

### 后续任务依赖
- **任务002**：需要本任务提供的项目结构和JPA配置
- **任务008**：需要本任务提供的应用程序配置用于Docker化

## 成功指标

### 启动验证
- [ ] 应用程序可以无错误启动
- [ ] 数据库连接池正常工作
- [ ] 健康检查端点返回UP状态
- [ ] JPA基础配置生效

### 代码质量
- [ ] 符合Java编码规范
- [ ] Maven构建成功
- [ ] 基础测试通过
- [ ] 没有代码警告或错误

### 文档完整性
- [ ] README文档包含本地开发环境设置说明
- [ ] 配置文件有适当的注释
- [ ] 项目结构清晰合理

---

**工作量估算**: 2天
**优先级**: 高（基础设施任务）
**并行性**: 否（其他任务的前置条件）