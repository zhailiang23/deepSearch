# 005 - 前端基础

## 基本信息
- **任务编号**: 005
- **任务名称**: 前端基础
- **估算工作量**: 2-3天
- **优先级**: 高
- **状态**: pending
- **创建时间**: 2025-09-21T08:08:39Z

## 依赖关系
- **依赖任务**: [001 - 项目初始化与配置]
- **并行开发**: true
- **阻塞任务**: []

## 任务描述
搭建Vue 3项目基础架构，集成shadcn-vue组件库，实现通用布局组件和基础工具函数，为管理系统前端开发提供坚实基础。

## 验收标准
- [ ] Vue 3项目搭建完成（Vite + TypeScript）
- [ ] shadcn-vue组件库集成
- [ ] 响应式布局组件实现
- [ ] 路由系统配置
- [ ] 状态管理（Pinia）配置
- [ ] HTTP客户端配置（Axios）
- [ ] 主题系统实现
- [ ] 国际化支持（i18n）
- [ ] 开发工具配置（ESLint、Prettier）
- [ ] 构建和部署配置

## 技术实施

### 项目结构
```
frontend/
├── public/
│   └── favicon.ico
├── src/
│   ├── assets/
│   │   ├── styles/
│   │   │   ├── globals.css
│   │   │   └── tailwind.css
│   │   └── images/
│   ├── components/
│   │   ├── ui/           # shadcn-vue 组件
│   │   ├── common/       # 通用组件
│   │   └── layout/       # 布局组件
│   ├── composables/      # 组合式函数
│   ├── layouts/          # 页面布局
│   ├── pages/           # 页面组件
│   ├── router/          # 路由配置
│   ├── stores/          # 状态管理
│   ├── utils/           # 工具函数
│   ├── types/           # TypeScript类型
│   ├── locales/         # 国际化文件
│   ├── App.vue
│   └── main.ts
├── package.json
├── vite.config.ts
├── tailwind.config.js
├── tsconfig.json
└── .eslintrc.js
```

### 核心技术栈
- **框架**: Vue 3 + Composition API
- **构建工具**: Vite
- **语言**: TypeScript
- **UI组件**: shadcn-vue + Tailwind CSS
- **路由**: Vue Router 4
- **状态管理**: Pinia
- **HTTP客户端**: Axios
- **国际化**: Vue I18n
- **代码规范**: ESLint + Prettier

## 关键组件实现

### 1. 主布局组件
```vue
<!-- src/layouts/DefaultLayout.vue -->
<template>
  <div class="min-h-screen bg-background">
    <!-- 侧边栏 -->
    <aside
      :class="[
        'fixed inset-y-0 left-0 z-50 w-64 bg-card border-r transition-transform duration-300',
        sidebarCollapsed ? '-translate-x-full lg:translate-x-0 lg:w-20' : 'translate-x-0'
      ]"
    >
      <SidebarNav />
    </aside>

    <!-- 主内容区 -->
    <div :class="['lg:ml-64', sidebarCollapsed && 'lg:ml-20']">
      <!-- 顶部导航 -->
      <header class="sticky top-0 z-40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b">
        <TopNav @toggle-sidebar="toggleSidebar" />
      </header>

      <!-- 页面内容 -->
      <main class="p-6">
        <router-view />
      </main>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import SidebarNav from '@/components/layout/SidebarNav.vue'
import TopNav from '@/components/layout/TopNav.vue'

const sidebarCollapsed = ref(false)

const toggleSidebar = () => {
  sidebarCollapsed.value = !sidebarCollapsed.value
}
</script>
```

### 2. 顶部导航组件
```vue
<!-- src/components/layout/TopNav.vue -->
<template>
  <div class="flex h-16 items-center justify-between px-6">
    <!-- 左侧：菜单按钮和面包屑 -->
    <div class="flex items-center space-x-4">
      <Button
        variant="ghost"
        size="sm"
        @click="$emit('toggle-sidebar')"
        class="lg:hidden"
      >
        <Menu class="h-4 w-4" />
      </Button>

      <Breadcrumb />
    </div>

    <!-- 右侧：用户菜单和设置 -->
    <div class="flex items-center space-x-4">
      <ThemeToggle />
      <LanguageSelector />
      <UserMenu />
    </div>
  </div>
</template>

<script setup lang="ts">
import { Menu } from 'lucide-vue-next'
import { Button } from '@/components/ui/button'
import Breadcrumb from '@/components/common/Breadcrumb.vue'
import ThemeToggle from '@/components/common/ThemeToggle.vue'
import LanguageSelector from '@/components/common/LanguageSelector.vue'
import UserMenu from '@/components/common/UserMenu.vue'

defineEmits(['toggle-sidebar'])
</script>
```

### 3. 侧边栏导航组件
```vue
<!-- src/components/layout/SidebarNav.vue -->
<template>
  <div class="flex h-full flex-col">
    <!-- Logo区域 -->
    <div class="flex h-16 items-center px-6 border-b">
      <router-link to="/" class="flex items-center space-x-2">
        <div class="h-8 w-8 rounded bg-primary"></div>
        <span class="font-semibold text-lg">管理系统</span>
      </router-link>
    </div>

    <!-- 导航菜单 -->
    <nav class="flex-1 overflow-y-auto p-4">
      <ul class="space-y-2">
        <li v-for="item in navigation" :key="item.name">
          <router-link
            :to="item.to"
            :class="[
              'flex items-center space-x-3 px-3 py-2 rounded-md text-sm font-medium transition-colors',
              'hover:bg-accent hover:text-accent-foreground',
              $route.path === item.to ? 'bg-accent text-accent-foreground' : 'text-muted-foreground'
            ]"
          >
            <component :is="item.icon" class="h-5 w-5" />
            <span>{{ item.name }}</span>
          </router-link>
        </li>
      </ul>
    </nav>
  </div>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import { useRoute } from 'vue-router'
import { Dashboard, Users, Settings } from 'lucide-vue-next'

const $route = useRoute()

const navigation = computed(() => [
  { name: '仪表板', to: '/', icon: Dashboard },
  { name: '用户管理', to: '/users', icon: Users },
  { name: '系统设置', to: '/settings', icon: Settings },
])
</script>
```

## 状态管理配置

### Pinia Store配置
```typescript
// src/stores/auth.ts
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import type { User, LoginRequest } from '@/types/auth'
import { authApi } from '@/api/auth'

export const useAuthStore = defineStore('auth', () => {
  const token = ref<string | null>(localStorage.getItem('token'))
  const user = ref<User | null>(null)
  const loading = ref(false)

  const isAuthenticated = computed(() => !!token.value)

  const login = async (credentials: LoginRequest) => {
    loading.value = true
    try {
      const response = await authApi.login(credentials)
      token.value = response.token
      user.value = response.user
      localStorage.setItem('token', response.token)
      return response
    } finally {
      loading.value = false
    }
  }

  const logout = () => {
    token.value = null
    user.value = null
    localStorage.removeItem('token')
  }

  return {
    token,
    user,
    loading,
    isAuthenticated,
    login,
    logout
  }
})
```

## HTTP客户端配置

### Axios配置
```typescript
// src/utils/http.ts
import axios from 'axios'
import { useAuthStore } from '@/stores/auth'
import { useToast } from '@/components/ui/toast'

const http = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || '/api',
  timeout: 10000
})

// 请求拦截器
http.interceptors.request.use(
  (config) => {
    const authStore = useAuthStore()
    if (authStore.token) {
      config.headers.Authorization = `Bearer ${authStore.token}`
    }
    return config
  },
  (error) => Promise.reject(error)
)

// 响应拦截器
http.interceptors.response.use(
  (response) => response.data,
  (error) => {
    const { toast } = useToast()
    const authStore = useAuthStore()

    if (error.response?.status === 401) {
      authStore.logout()
      toast({
        title: '认证失败',
        description: '请重新登录',
        variant: 'destructive'
      })
    }

    return Promise.reject(error)
  }
)

export default http
```

## 路由配置

### Vue Router配置
```typescript
// src/router/index.ts
import { createRouter, createWebHistory } from 'vue-router'
import { useAuthStore } from '@/stores/auth'

const routes = [
  {
    path: '/',
    component: () => import('@/layouts/DefaultLayout.vue'),
    meta: { requiresAuth: true },
    children: [
      {
        path: '',
        name: 'Dashboard',
        component: () => import('@/pages/Dashboard.vue')
      },
      {
        path: '/users',
        name: 'Users',
        component: () => import('@/pages/users/UserList.vue')
      }
    ]
  },
  {
    path: '/login',
    name: 'Login',
    component: () => import('@/pages/auth/Login.vue'),
    meta: { guest: true }
  }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

// 路由守卫
router.beforeEach((to, from, next) => {
  const authStore = useAuthStore()

  if (to.meta.requiresAuth && !authStore.isAuthenticated) {
    next('/login')
  } else if (to.meta.guest && authStore.isAuthenticated) {
    next('/')
  } else {
    next()
  }
})

export default router
```

## 主题系统实现

### Tailwind CSS配置
```javascript
// tailwind.config.js
module.exports = {
  darkMode: 'class',
  content: ['./index.html', './src/**/*.{vue,js,ts,jsx,tsx}'],
  theme: {
    extend: {
      colors: {
        border: 'hsl(var(--border))',
        input: 'hsl(var(--input))',
        ring: 'hsl(var(--ring))',
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))'
        },
        secondary: {
          DEFAULT: 'hsl(var(--secondary))',
          foreground: 'hsl(var(--secondary-foreground))'
        }
      }
    }
  },
  plugins: [require('tailwindcss-animate')]
}
```

## 开发工具配置

### Vite配置
```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  },
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true
      }
    }
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['vue', 'vue-router', 'pinia'],
          ui: ['@radix-ui/vue-dialog', '@radix-ui/vue-dropdown-menu']
        }
      }
    }
  }
})
```

## 国际化配置

### i18n设置
```typescript
// src/locales/index.ts
import { createI18n } from 'vue-i18n'
import zh from './zh-CN.json'
import en from './en-US.json'

export default createI18n({
  legacy: false,
  locale: 'zh-CN',
  fallbackLocale: 'en-US',
  messages: {
    'zh-CN': zh,
    'en-US': en
  }
})
```

## 测试配置

### Vitest配置
```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  plugins: [vue()],
  test: {
    environment: 'jsdom',
    globals: true
  },
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  }
})
```

## 性能优化

### 代码分割和懒加载
- 路由级别代码分割
- 组件懒加载
- 第三方库分离

### 构建优化
- Tree shaking
- 资源压缩
- 缓存策略

## 部署配置

### Docker配置
```dockerfile
# Dockerfile
FROM node:18-alpine as builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

## 后续扩展
- PWA支持
- 微前端架构
- 移动端适配
- 性能监控集成