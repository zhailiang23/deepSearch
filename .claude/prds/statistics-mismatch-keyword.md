---
name: statistics-mismatch-keyword
description: 银行搜索系统中高不匹配度关键词统计分析功能，基于分词实时计算Top10不匹配关键词排行榜
status: backlog
created: 2025-09-28T07:04:06Z
updated: 2025-09-28T07:21:44Z
---

# PRD: statistics-mismatch-keyword

## Executive Summary

本功能通过实时分析searchLog表中的用户搜索数据，基于分词技术计算关键词的不匹配度，为银行产品运营团队提供Top10高不匹配度关键词排行榜，帮助他们识别用户搜索痛点并优化产品内容，提升搜索成功率和用户体验。

核心价值：精准识别用户搜索需求与产品内容的差距，为产品优化提供数据驱动的决策支持。

## Problem Statement

### 当前痛点
- **搜索词粒度问题**：用户输入的完整搜索句子包含多个词汇，直接分析整句无法精确定位问题关键词
- **实时性缺失**：缺乏实时的关键词不匹配分析，无法及时发现和响应用户搜索问题
- **优化盲区**：不知道哪些具体的关键词导致搜索失败，优化工作缺乏针对性
- **资源浪费**：无法识别最需要优化的关键词，导致优化资源分散使用

### 业务影响
- 用户体验差：高频但无结果或少结果的关键词搜索导致用户挫败感
- 机会成本高：有价值的关键词因匹配不佳而无法转化为业务
- 决策效率低：缺乏数据支持的优化决策可能偏离用户真实需求
- 搜索质量不一致：无法区分完全无结果和结果质量较差的搜索问题

## User Stories

### 主要用户角色

#### 数据分析师
**用户故事**：
- 作为数据分析师，我希望能够选择不同的时间范围（7天/30天/90天）查看关键词不匹配分析，以便了解不同时期的搜索问题
- 作为数据分析师，我希望看到基于分词后的关键词统计而不是原始搜索句子，以便更精确地定位问题词汇
- 作为数据分析师，我希望看到实时计算的Top10不匹配关键词，以便快速识别最需要关注的问题

**验收标准**：
- 能够在页面上选择7天、30天、90天三个时间范围
- 页面选择时间范围后，后端实时计算并返回对应时期的Top10关键词
- 显示的是分词后的关键词而非用户原始输入

#### 产品经理
**用户故事**：
- 作为产品经理，我希望快速获得最需要优化的10个关键词，以便集中资源进行针对性改进
- 作为产品经理，我希望了解每个关键词的搜索频次、无结果次数、少结果次数和综合不匹配率，以便评估优化的紧急程度和潜在价值
- 作为产品经理，我希望能够快速切换不同时间段查看问题关键词变化，以便制定短期和长期优化策略

**验收标准**：
- 排行榜只显示Top10关键词，聚焦最重要的问题
- 每个关键词显示详细的统计数据（搜索次数、无结果次数、少结果次数、不匹配率）
- 支持快速切换时间范围查看不同时期的问题关键词

## Requirements

### Functional Requirements

#### FR001: 分词处理
- 系统应对用户原始搜索输入进行中文分词处理
- 支持常见的中文分词算法（如jieba、HanLP等）
- 过滤停用词（如"的"、"和"、"在"等）
- 只统计长度≥2个字符的关键词

#### FR002: 不匹配度计算算法
- **核心算法**：采用分层权重的不匹配度计算方式
  - 完全无结果搜索：权重 = 1.0
  - 少结果搜索（结果数 ≤ 阈值）：权重 = 0.6
  - 不匹配度 = (无结果搜索次数 × 1.0 + 少结果搜索次数 × 0.6) / 总搜索次数 × 100%
- **少结果阈值定义**：
  - 搜索结果数量 ≤ 3条视为"少结果"
  - 可在系统配置中调整该阈值
- **增强因素考虑**：
  - 搜索频次权重：高频关键词优先级更高
  - 时间衰减：近期搜索给予更高权重
  - 用户行为：考虑用户搜索后的停留时间或跳出率
- 只统计搜索次数≥5次的关键词

#### FR003: Top10排行榜生成
- 按不匹配度降序排列，只返回前10个关键词
- 实时计算，不使用缓存或预计算结果
- 排行榜包含字段：关键词、搜索次数、无结果次数、少结果次数、不匹配率、排名

#### FR004: 时间范围筛选
- 支持三个固定时间范围：最近7天、最近30天、最近90天
- 默认显示最近30天数据
- 用户选择时间范围后，页面立即触发后端实时计算
- 计算基于searchLog表中的timestamp字段

#### FR005: 少结果阈值配置
- 系统提供"少结果"阈值的配置功能
- 默认阈值设为3条搜索结果
- 支持管理员通过配置文件或管理界面调整阈值
- 阈值变更后实时生效，影响后续的不匹配度计算

#### FR006: 实时数据处理
- 基于当前searchLog表数据实时计算，不依赖定时任务
- 页面加载或切换时间范围时触发计算
- 支持数据量大的情况下的性能优化（如索引优化、查询优化）
- 需要记录每次搜索的结果数量以支持少结果统计

### Non-Functional Requirements

#### NFR001: 性能要求
- 实时计算响应时间 ≤ 5秒（包含分词和统计计算）
- 支持单次处理10万条搜索记录
- 分词处理速度 ≥ 1000词/秒
- 页面加载时间 ≤ 3秒

#### NFR002: 准确性要求
- 分词准确率 ≥ 95%
- 统计计算准确率 ≥ 99.9%
- 排行榜结果一致性：相同条件下多次查询结果一致

#### NFR003: 可扩展性
- 支持日均10万次搜索记录的分析
- 支持并发5个用户同时进行分析
- 分词算法可配置和替换

#### NFR004: 可用性
- 提供友好的加载提示（实时计算进行中）
- 计算超时或失败时提供明确的错误信息
- 支持计算中断和重试机制

## Success Criteria

### 功能完成度指标
- **核心功能可用性**：分词、统计计算、排行榜生成功能正常运行率 ≥ 99%
- **响应时间达标率**：实时计算在5秒内完成的比例 ≥ 95%
- **数据准确性**：与手工验证结果一致性 ≥ 99%

### 业务价值指标
- **用户采用率**：目标用户（数据分析师、产品经理）月使用率 ≥ 80%
- **问题识别效率**：识别Top10问题关键词平均时间 ≤ 30秒
- **优化指导价值**：基于排行榜进行的关键词优化成功率 ≥ 70%

### 技术性能指标
- **分词准确率**：中文分词结果准确性 ≥ 95%
- **系统稳定性**：7×24小时无故障运行时间 ≥ 99.5%
- **并发处理能力**：支持5个用户同时使用无性能劣化

## Constraints & Assumptions

### 技术约束
- 必须使用现有Spring Boot + Vue.js + PostgreSQL技术栈
- 分词处理需要集成中文分词库
- 实时计算不能影响现有searchLog表的正常使用
- 需要优化数据库查询性能以支持实时计算

### 业务约束
- 只分析中文关键词，暂不支持英文或其他语言
- 不能修改现有searchLog表结构
- 需要保护用户隐私，不暴露具体用户信息
- 计算结果仅供内部运营团队使用

### 性能约束
- 实时计算不能占用过多数据库资源
- 分词处理需要在合理的内存范围内完成
- 并发用户数限制在10人以内

### 关键假设
- searchLog表数据完整且包含必要字段（关键词、时间戳、搜索结果状态、结果数量）
- 用户搜索行为相对稳定，不会出现极端的数据波动
- 分词效果能够满足银行业务场景的准确性要求
- 后端服务器性能足以支持实时计算需求
- searchLog表能够准确记录每次搜索返回的结果数量

## Out of Scope

### 明确不包含的功能
- **历史趋势分析**：不提供关键词不匹配度的时间趋势图表
- **用户个性化分析**：不分析特定用户群体的搜索模式
- **自动优化建议**：不提供自动化的产品优化建议
- **批量数据导出**：不支持大批量数据导出功能
- **实时监控告警**：不提供关键词不匹配度异常告警
- **多维度分析**：不支持按用户类型、地区等维度分析
- **搜索结果优化**：不直接修改搜索算法或结果排序

### 后续版本考虑
- 关键词优化效果追踪
- 更复杂的不匹配度计算算法
- 用户群体细分析
- 与产品管理系统集成

## Dependencies

### 外部依赖
- **searchLog数据表**：包含用户搜索记录的完整数据
- **中文分词库**：如jieba、HanLP等开源分词工具
- **数据库性能**：PostgreSQL需要支持复杂查询的快速执行

### 内部团队依赖
- **数据团队**：确认searchLog表结构和数据质量
- **DBA团队**：数据库查询优化和索引设计
- **运维团队**：服务器性能监控和优化

### 技术依赖
- PostgreSQL数据库稳定运行
- JVM内存充足以支持分词处理
- 网络稳定以保证实时数据传输
- 现有API网关和认证系统

### 关键路径
1. 分词算法选型和集成（第1周）
2. 数据库查询优化和索引设计（第1-2周）
3. 后端实时计算逻辑开发（第2-3周）
4. 前端交互界面开发（第3-4周）
5. 性能测试和优化（第4-5周）
6. 系统集成测试（第5-6周）

---

## 技术实现要点

### 分词处理方案
- 推荐使用jieba分词库（Java版本）
- 配置银行业务专用词典
- 实现停用词过滤和词长筛选

### 数据库优化策略
- 在searchLog表的timestamp、关键词和结果数量字段添加复合索引
- 使用SQL查询优化减少实时计算时间
- 考虑使用数据库视图简化复杂查询
- 确保searchLog表记录搜索结果数量字段用于少结果统计

### 缓存策略
- 对分词结果进行短期缓存（1小时）
- 对相同时间范围的查询结果缓存（15分钟）
- 使用Redis存储临时计算结果